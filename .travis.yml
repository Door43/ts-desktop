language: node_js
node_js:
- '6'
os:
- 'linux'
sudo: true
cache:
  directories:
    - node_modules
before_install:
# Inno Setup (for Windows installer)
- sudo add-apt-repository --yes ppa:arx/release
- sudo apt-get update -d
- sudo apt-get install -y -q innoextract wine python-software-properties
- wine --version
- innoextract --version
- ./scripts/innosetup/innoinstall.sh
- sudo cp scripts/innosetup/iscc /usr/local/bin/iscc
- iscc /? 2> /dev/null | grep "Inno Setup Preprocessor"
before_script:
- npm install
- npm install gulp -g
script: npm test
after_success:
- gulp build
- ./scripts/download_git.sh ./vendor 2.9.2 64
- ./scripts/download_git.sh ./vendor 2.9.2 32
- iscc win64_installer.iss
- iscc win32_installer.iss
# TODO: upload
#before_install:
#- if [ "${TRAVIS_PULL_REQUEST}" = "false" ]; then openssl aes-256-cbc -K $encrypted_54b2df9dba46_key -iv $encrypted_54b2df9dba46_iv -in config.json.enc -out unit_tests/git/config.json -d; fi

